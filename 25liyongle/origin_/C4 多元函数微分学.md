# 本章考点

- 多元函数的概念
- 二元函数的几何意义
- 二元函数的极限与连续的概念
- 有界闭区域上多元连续函数的性质
- 多元函数的偏导数和全微分
- 多元复合函数、隐函数的求导法
- 二阶偏导数
- 多元函数的极值和条件极值
- 多元函数的最大值、最小值及其简单应用
- 全微分存在的必要条件和充分条件
- 全微分形式的不变性
- 二元函数的二阶参数公式
- 方向导数、梯度及几何应用

# 第一节 多元函数的极限与连续

## 一、二元函数的概念

**定义**：设 $D$ 是平面上的一个点集，如果对每一个点 $P(x, y) \in D$，变量 $z$ 按照一定法则总有确定的值和它对应，则称 $z$ 是变量 $x, y$ 的二元函数，记为 $z=f(x, y)$。

其中点集 $D$ 称为函数 $f(x, y)$ 的定义域，$x, y$ 称为自变量，$z$ 称为因变量，数集 $\{z \mid z=f(x, y),(x, y) \in D\}$ 称为函数 $z=f(x, y)$ 的值域。

类似地可以定义三元函数 $u=f(x, y, z)$ 及三元以上的函数。但在考试中重点考查二元函数。

**二元函数的几何意义**：空间点集 $\{(x, y, z) \mid z=f(x, y),(x, y) \in D\}$ 构成二元函数 $z=f(x, y)$ 的图形。通常情况下，二元函数 $z=f(x, y)$ 的图形是一张曲面，定义域 $D$ 便是该曲面在 $x O y$ 平面上的投影。

## 二、二元函数的极限与连续

### 1. 重极限的概念

**定义**：设函数 $f(x, y)$ 在开区域（或闭区域） $D$ 内有定义，$P_{0}\left(x_{0}, y_{0}\right)$ 是 $D$ 的内点或边界点，如果对任意给定的 $\varepsilon>0$，$\exists \delta>0$，使得对适合不等式

$$
0<\sqrt{\left(x-x_{0}\right)^{2}+\left(y-y_{0}\right)^{2}}<\delta
$$

的一切的 $P(x, y) \in D$，都有 $\left|f(x, y)-A\right|<\varepsilon$，则称 $A$ 为 $f(x, y)$ 当 $x \rightarrow x_{0}, y \rightarrow y_{0}$ 时的极限，记为 $\lim _{x \rightarrow x_{0}} f(x, y)=A$。

**注释**：
1. 二元函数的重极限是指定义域 $D$ 中的点 $P(x, y)$ 以任何方式趋于点 $P_{0}\left(x_{0}, y_{0}\right)$ 时，函数 $f(x, y)$ 都无限趋近于同一常数 $A$。换言之，若点 $P(x, y)$ 沿两种不同路径趋向于点 $P_{0}\left(x_{0}, y_{0}\right)$ 时，$f(x, y)$ 趋于不同常数，或点 $P(x, y)$ 沿某一路径趋于 $P_{0}\left(x_{0}, y_{0}\right)$ 时，$f(x, y)$ 的极限不存在，则重极限 $\lim _{x \rightarrow x_{0}} f(x, y)$ 不存在。这是证明重极限不存在常用的有效方法。
2. 重极限的极限运算（有理运算，复合运算）和性质（保号性、夹逼性和局部有界性等）与一元函数完全类似。

**例题**：
1. 证明下列重极限不存在：
   - $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y}{x^{2}+y^{2}}$
   - $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}$

**证明**：
1. 取直线 $y=k x$，让点 $(x, y)$ 沿直线 $y=k x$ 趋于 $(0,0)$ 点，此时有

   $$
   \lim _{\substack{x \rightarrow k \\ y \rightarrow 0}} \frac{x y}{x^{2}+y^{2}}=\lim _{x \rightarrow 0} \frac{k x^{2}}{x^{2}+k^{2} x^{2}}=\frac{k}{1+k^{2}}
   $$

   显然，点 $(x, y)$ 沿不同直线 $y=k x$ 趋于点 $(0,0)$ 时，极限值不相同，则重极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y}{x^{2}+y^{2}}$ 不存在。

2. 取直线 $y=k x$，则

   $$
   \lim _{\substack{x \rightarrow k_{0} \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}=\lim _{x \rightarrow 0} \frac{k^{2} x^{3}}{x^{2}+k^{4} x^{4}}=\lim _{x \rightarrow 0} \frac{k^{2} x}{1+k^{4} x^{2}}=0
   $$

   这说明沿任何一条过原点的直线 $y=k x$（不包括 $y$ 轴）趋于 $(0,0)$ 点时，极限存在且都为零，并且若沿 $y$ 轴趋于 $(0,0)$ 点极限也为零，事实上

   $$
   \lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}=0
   $$

   这能否说明重极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}$ 存在且为零呢？不能！事实上若沿过原点的抛物线 $x=y^{2}$ 趋于 $(0,0)$ 点时，就有

   $$
   \lim _{\substack{x \rightarrow 2 \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}=\lim _{y \rightarrow 0} \frac{y^{4}}{y^{4}+y^{4}}=\frac{1}{2}
   $$

   故重极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{x y^{2}}{x^{2}+y^{4}}$ 不存在。

2. 试求下列函数的二重极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} f(x, y)$：
   - $f(x, y)=x \sin \frac{1}{y}+y \sin \frac{1}{x}$
   - $f(x, y)=\frac{\ln \left(1+x^{2}+y^{2}\right)}{x^{2}+y^{2}}$
   - $f(x, y)=\frac{x+y}{|x|+|y|}$
   - $f(x, y)=(1+x)^{\frac{y+1}{x}}$

**解**：
1. $|f(x, y)| \leqslant|x| \mid \sin \frac{1}{y}|+|y| \mid \sin \frac{1}{x}|\leqslant|x|+|y|$，所以 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} f(x, y)=0$。
2. 令 $\rho^{2}=x^{2}+y^{2}$，

   $$
   \lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} f(x, y)=\lim _{\rho \rightarrow 0} \frac{\ln \left(1+\rho^{2}\right)}{\rho^{2}}=1
   $$

3. 取直线 $x=y$，当 $(x, y)$ 沿直线趋于 $(0,0)$ 点时，$\lim _{x \rightarrow 0^{+}} f(x, y)=\lim _{x \rightarrow 0} \frac{2 x}{2|x|}$ 不存在，所以 $\lim _{x \rightarrow 0} f(x, y)$ 不存在。
4. $f(x, y)=(1+x)^{\frac{1}{2} \cdot(y+1)}$，而 $\lim _{x \rightarrow 0}(1+x)^{\frac{1}{2}}=\mathrm{e}$，所以 $\lim _{x \rightarrow 0} f(x, y)=\mathrm{e}$。

**评注**：求一元函数极限的常见方法：不等式缩放，等价无穷小替换，泰勒展开，两个常见极限：$\lim _{x \rightarrow 0}(1+x)^{\frac{1}{x}}=\mathrm{e}, \lim _{x \rightarrow 0} \frac{\sin x}{x}=1$ 都可以用在多元函数的极限计算。

### 2. 二元函数连续的概念

**定义**：设函数 $f(x, y)$ 在开区域（或闭区域） $D$ 内有定义，$P_{0}\left(x_{0}, y_{0}\right)$ 是 $D$ 的内点或边界点，且 $P_{0} \in D$，如果 $\lim _{x \rightarrow y_{0}} f(x, y)=f\left(x_{0}, y_{0}\right)$，则称函数 $f(x, y)$ 在点 $P_{0}\left(x_{0}, y_{0}\right)$ 处连续。

**例题**：
1. 讨论函数 $f(x, y)= \begin{cases}\frac{x}{y^{2}} \mathrm{e}^{-\frac{x^{2}}{y^{2}}}, & y \neq 0, \\ 0, & y=0\end{cases}$ 的连续性。

**解**：当 $y_{0} \neq 0$ 时，$\forall x_{0} \in \mathbf{R}, f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 点连续。当 $y_{0}=0$ 时，分 $x_{0}=0$ 和 $x_{0} \neq 0$ 两种情况讨论 $f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 点的连续性。

- 当 $x_{0}=0$ 时，$(x, y)$ 沿直线 $y=x$ 趋于 $(0,0)$ 点时，

  $$
  \lim _{\substack{x \rightarrow 0 \\ y \rightarrow x}} f(x, y)=\lim _{x \rightarrow 0} \frac{1}{x} \mathrm{e}^{-1}
  $$

  不存在，所以 $\lim _{x \rightarrow 0} f(x, y)$ 不存在，$f(x, y)$ 在 $(0,0)$ 点不连续。

- 当 $y_{0}=0, x_{0} \neq 0$ 时，$(x, y) \rightarrow\left(x_{0}, y_{0}\right)$

  $$
  \begin{gathered}
  f(x, y)=\frac{1}{x} \frac{x^{2}}{y^{2}} \mathrm{e}^{\frac{x^{2}}{y^{2}}} \\
  \lim _{x \rightarrow y_{0}} f(x, y)=0
  \end{gathered}
  $$

  所以 $f(x, y)$ 在 $\left(x_{0}, 0\right)\left(x_{0} \neq 0\right)$ 点连续。

$f(x, y)$ 在 $\mathbf{R}^{2}$ 中只有一个不连续点 $(0,0)$。

2. 讨论函数 $f(x, y)= \begin{cases}\frac{x^{2} y^{2}}{\left(x^{2}+y^{2}\right)^{\frac{3}{2}}}, & x^{2}+y^{2} \neq 0, \\ 0, & x^{2}+y^{2}=0\end{cases}$ 在 $(0,0)$ 点处的连续性。

**解**：$\lim _{x \rightarrow 0} f(x, y)=\lim _{r \rightarrow 0} \frac{r^{4} \cos ^{2} \theta \sin ^{2} \theta}{r^{3}}=\lim _{r \rightarrow 0} r \cos ^{2} \theta \sin ^{2} \theta=0=f(0,0)$，其中 $x=r \cos \theta, y=r \sin \theta$，所以 $f(x, y)$ 在 $(0,0)$ 处连续。

**评注**：由 $0 \leqslant \frac{x^{2} y^{2}}{\left(x^{2}+y^{2}\right)^{\frac{3}{2}}} \leqslant \frac{1}{4} \sqrt{x^{2}+y^{2}}$，用夹逼准则，有 $\lim _{x \rightarrow 0} f(x, y)=0=f(0,0)$。

### 3. 多元连续函数的性质

多元函数有与一元函数完全类似的性质：
1. 连续函数的和、差、积、商（分母不为零）仍是连续函数，连续函数的复合函数仍为连续函数。
2. （最大最小值定理）在有界闭区域 $D$ 上连续的函数，在该区域 $D$ 上有最大值和最小值。
3. （介值定理）在有界闭区域 $D$ 上连续的函数，可取到它在该区域上的最小值与最大值之间的任何值。
4. 一切多元初等函数在其定义区域内处处连续。这里的定义区域是指包含在定义域内的区域或闭区域。

# 第二节 多元函数的微分

## 一、二元函数的偏导数与全微分

**定义**：设函数 $z=f(x, y)$ 在点 $\left(x_{0}, y_{0}\right)$ 的某一邻域内有定义，如果

$$
\lim _{\Delta x \rightarrow 0} \frac{f\left(x_{0}+\Delta x, y_{0}\right)-f\left(x_{0}, y_{0}\right)}{\Delta x}
$$

存在，则称此极限为函数 $z=f(x, y)$ 在点 $\left(x_{0}, y_{0}\right)$ 处对 $x$ 的偏导数，记为 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)$ 或 $\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial x}$。

类似地可定义

$$
f_{y}^{\prime}\left(x_{0}, y_{0}\right)=\lim _{\Delta y \rightarrow 0} \frac{f\left(x_{0}, y_{0}+\Delta y\right)-f\left(x_{0}, y_{0}\right)}{\Delta y}
$$

也可记为 $\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial y}$。

**注释**：由以上定义不难看出偏导数本质上是一元函数的导数。事实上偏导数 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)$ 就是一元函数 $\varphi(x)=f\left(x, y_{0}\right)$ 在 $x=x_{0}$ 处的导数，即

$$
f_{x}^{\prime}\left(x_{0}, y_{0}\right)=\varphi^{\prime}\left(x_{0}\right)=\left.\frac{\mathrm{d} f\left(x, y_{0}\right)}{\mathrm{d} x}\right|_{x=x_{0}}
$$

而偏导数 $f_{y}^{\prime}\left(x_{0}, y_{0}\right)$ 就是一元函数 $\psi(y)=f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数，即

$$
f_{y}^{\prime}\left(x_{0}, y_{0}\right)=\psi^{\prime}\left(y_{0}\right)=\left.\frac{\mathrm{d} f\left(x_{0}, y\right)}{\mathrm{d} y}\right|_{y=y_{0}}
$$

类似地，可以定义三元函数乃至 $n$ 元函数的偏导数。

**偏导数的几何意义**：偏导数 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)$ 在几何上表示曲面 $z=f(x, y)$ 与平面 $y=y_{0}$ 的交线在点 $M_{0}\left(x_{0}, y_{0}, f\left(x_{0}, y_{0}\right)\right)$ 处的切线 $T_{x}$ 对 $x$ 轴的斜率（如图 1），$f_{x}^{\prime}\left(x_{0}, y_{0}\right)=\tan \alpha$。

偏导数 $f_{y}^{\prime}\left(x_{0}, y_{0}\right)$ 在几何上表示曲面 $z=f(x, y)$ 与平面 $x=x_{0}$ 的交线在点 $M_{0}\left(x_{0}, y_{0}, f\left(x_{0}, y_{0}\right)\right)$ 处的切线 $T_{y}$ 对 $y$ 轴的斜率（如图 1），$f_{y}^{\prime}\left(x_{0}, y_{0}\right)=\tan \beta$。

**定义**：如果函数 $z=f(x, y)$ 在点 $(x, y)$ 处的全增量 $\Delta z=f(x+\Delta x, y+\Delta y)-f(x, y)$ 可表示为

$$
\Delta z=A \Delta x+B \Delta y+o(\rho)
$$

其中 $A, B$ 不依赖于 $\Delta x, \Delta y$，而仅与 $x, y$ 有关，$\rho=\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}$，则称函数 $z=f(x, y)$ 在点 $(x, y)$ 可微。而 $A \Delta x+B \Delta y$ 称为函数 $z=f(x, y)$ 在点 $(x, y)$ 的全微分，记为

$$
\mathrm{d} z=A \Delta x+B \Delta y
$$

**全微分存在的必要条件**：如果函数 $z=f(x, y)$ 在点 $(x, y)$ 处可微，则该函数在点 $(x, y)$ 处的偏导数 $\frac{\partial z}{\partial x}, \frac{\partial z}{\partial y}$ 必定存在，且

$$
\mathrm{d} z=\frac{\partial z}{\partial x} \mathrm{~d} x+\frac{\partial z}{\partial y} \mathrm{~d} y
$$

**全微分存在的充分条件**：如果函数 $z=f(x, y)$ 的偏导数 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$ 在点 $(x, y)$ 处连续，则函数 $z=f(x, y)$ 在该点可微。

对二元函数 $z=f(x, y)$，我们称它在点 $(x, y)$ 可导是指它在点 $(x, y)$ 处两个一阶偏导数 $\frac{\partial z}{\partial x}, \frac{\partial z}{\partial y}$ 都存在。则二元函数的连续、可导及可微的关系如图 2 所示。

由图 2 可以看出一元函数和多元函数的连续、可导、可微之间的关系主要不同在于，一元函数可导能推得连续，也能推得可微；而多元函数的可导既不能推得连续，也不能推得可微。其主要原因在于多元函数的可导是指一阶偏导数存在，而偏导数是用一元函数极限定义的（$f_{x}^{\prime}\left(x_{0}, y_{0}\right)=\lim _{x \rightarrow x_{0}} \frac{f\left(x, y_{0}\right)-f\left(x_{0}, y_{0}\right)}{x-x_{0}}$，$f_{x}^{\prime}\left(x_{0}, y_{0}\right)=\lim _{y \rightarrow y_{0}} \frac{f\left(x_{0}, y\right)-f\left(x_{0}, y_{0}\right)}{y-y_{0}}$），其动点 $\left(x, y_{0}\right)$（或 $\left(x_{0}, y\right)$）是沿 $x$（或 $y$）轴方向趋于 $\left(x_{0}, y_{0}\right)$，它只与点 $\left(x_{0}, y_{0}\right)$ 邻域内过该点且平行于两坐标轴的十字架方向函数值有关；而连续（$\lim _{(x, y) \rightarrow\left(x_{0}, y_{0}\right)} f(x, y)=f\left(x_{0}, y_{0}\right)$）和可微（$f(x, y)-f\left(x_{0}, y_{0}\right)=A\left(x-x_{0}\right)+B\left(y-y_{0}\right)+o(\rho)$）都是用重极限定义的，其动点 $(x, y)$ 是以任意方式趋于 $\left(x_{0}, y_{0}\right)$，它与点 $\left(x_{0}, y_{0}\right)$ 邻域内函数值有关。

**例题**：
1. 设 $z=\left(\sin y^{3}+x^{2}\right)\left(x+\sin y^{5}\right) \frac{x^{3}}{y^{3}+x^{2^{3}}}$，求 $\left.\frac{\partial z}{\partial x}\right|_{(1,0)}$。

**解**：由偏导数的定义

$$
\left.\frac{\partial z}{\partial x}\right|_{(1,0)}=\left.\frac{\mathrm{d} z(x, 0)}{\mathrm{d} x}\right|_{x=1}=\left.\left(x^{3}\right)^{\prime}\right|_{x=1}=3
$$

2. 二元函数 $f(x, y)=\left\{\begin{array}{cl}\frac{x y}{x^{3}+y^{2}}, & x^{2}+y^{2} \neq 0, \\ 0, & x^{2}+y^{2}=0\end{array}\right.$ 在 $(0,0)$ 处

- (A) 连续，偏导数存在。
- (C) 不连续，偏导数存在。
- (B) 连续，偏导数不存在。
- (D) 不连续，偏导数不存在。

**解**：当 $(x, y)$ 沿 $y=k x(k \neq 0)$ 趋向点 $(0,0)$ 时，$\lim _{\substack{x \rightarrow 0 \\ y=k x}} f(x, y)=\lim _{x \rightarrow 0} \frac{k x^{2}}{x^{2}+k^{2} x^{2}}=\frac{1}{k}$，$k$ 取不同值，上式结果不唯一，所以函数在 $(0,0)$ 处极限不存在，因此不连续。又因为 $f_{x}^{\prime}(0,0)=\lim _{\Delta x \rightarrow 0} \frac{f(0+\Delta x, 0)-f(0,0)}{\Delta x}=0$，同理可得 $f_{x}^{\prime}(0,0)=0$，所以 $f(x, y)$ 在 $(0,0)$ 处偏导数存在。故本题答案选（C）。

**评注**：误把一元函数的"可导必连续"应用到二元函数中，选择 (A) 是经典错误。

3. 极限 $\lim _{(x, y) \rightarrow(0,0)} \frac{f(x, y)-f(0,0)}{\sqrt{x^{2}+y^{2}}}=0$ 是二元函数 $f(x, y)$ 在点 $(0,0)$ 处可微的

- (A) 充分非必要条件。
- (B) 必要非充分条件。
- (C) 充分必要条件。
- (D) 既不是充分也不是必要条件。

**解**：如果 $\lim _{(x, y) \rightarrow(0,0)} \frac{f(x, y)-f(0,0)}{\sqrt{x^{2}+y^{2}}}=0$，则

$$
f_{x}^{\prime}(0,0)=\lim _{x \rightarrow 0} \frac{f(x, 0)-f(0,0)}{x}=\lim _{x \rightarrow 0} \frac{f(x, 0)-f(0,0)}{\sqrt{x^{2}+0^{2}}} \frac{\sqrt{x^{2}+0^{2}}}{x}=0
$$

同理 $f_{y}^{\prime}(0,0)=0$，因此函数 $f(x, y)$ 在 $(0,0)$ 处可微；取 $f(x, y)=x^{2}+y$，则函数 $f(x, y)$ 在 $(0,0)$ 处可微分，但

$$
\lim _{(x, y) \rightarrow(0,0)} \frac{f(x, y)-f(0,0)}{\sqrt{x^{2}+y^{2}}}=\lim _{(x, y) \rightarrow(0,0)} \frac{x^{2}+y}{\sqrt{x^{2}+y^{2}}}
$$

极限不存在，所以答案选 (A)。

**变式**：（供同学们自行思考）
如果函数 $f(x, y)$ 在 $(0,0)$ 处连续，那么下列命题正确的是
- (A) 若极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{f(x, y)}{|x|+|y|}$ 存在，则 $f(x, y)$ 在 $(0,0)$ 处可微。
- (B) 若极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{f(x, y)}{x^{2}+y^{2}}$ 存在，则 $f(x, y)$ 在 $(0,0)$ 处可微。
- (C) 若 $f(x, y)$ 在 $(0,0)$ 处可微，则极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{f(x, y)}{|x|+|y|}$ 存在。
- (D) 若 $f(x, y)$ 在 $(0,0)$ 处可微，则极限 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \frac{f(x, y)}{x^{2}+y^{2}}$ 存在。

**答案**：(B)

4. 函数 $f(x, y)=\left\{\begin{array}{cl}\left(x^{2}+y^{2}\right) \sin \frac{1}{x^{2}+y^{2}}, & x^{2}+y^{2} \neq 0, \\ 0, & x^{2}+y^{2}=0\end{array}\right.$

**解**：因为 $\left|\sin \frac{1}{x^{2}+y^{2}}\right| \leqslant 1,|f(x, y)| \leqslant x^{2}+y^{2}$，所以

$$
\lim _{\substack{y \rightarrow 0 \\ y \rightarrow 0}} f(x, y)=0
$$

$f(x, y)$ 在 $(0,0)$ 点连续。求 $f(x, y)$ 在 $(0,0)$ 点的偏导数。

$$
\begin{aligned}
& \lim _{\Delta y \rightarrow 0} \frac{f(0+\Delta x, 0)-f(0,0)}{\Delta x}=\lim _{\Delta y \rightarrow 0} \frac{(\Delta x)^{2} \sin \frac{1}{(\Delta x)^{2}}}{\Delta x}=0 \\
& \lim _{\Delta y \rightarrow 0} \frac{f(0,0+\Delta y)-f(0,0)}{\Delta y}=\lim _{\Delta y \rightarrow 0} \frac{(\Delta y)^{2} \sin \frac{1}{(\Delta y)^{2}}}{\Delta y}=0
\end{aligned}
$$

所以 $\left.\frac{\partial f}{\partial x}\right|_{(0,0)}=\left.\frac{\partial f}{\partial y}\right|_{(0,0)}=0$。下面考虑 $f(x, y)$ 在 $(0,0)$ 点的可微性。

$$
\begin{aligned}
& \frac{f(0+\Delta x, 0+\Delta y)-f(0,0)-\left[\left.\frac{\partial f}{\partial x}\right|_{(0,0)} \Delta x+\left.\frac{\partial f}{\partial y}\right|_{(0,0)} \Delta y\right]}{\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}} \\
& =\frac{\left[(\Delta x)^{2}+(\Delta y)^{2}\right] \sin \frac{1}{(\Delta x)^{2}+(\Delta y)^{2}}}{\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}}=\sqrt{(\Delta x)^{2}+(\Delta y)^{2}} \sin \frac{1}{(\Delta x)^{2}+(\Delta y)^{2}} \rightarrow 0
\end{aligned}
$$

当 $(\Delta x, \Delta y) \rightarrow 0$ 时，$f(x, y)$ 在 $(0,0)$ 点可微，且 $\mathrm{d} f(0,0)=0$。

5. 设 $f(x, y)=(x+y) \varphi(x, y)$，其中 $\varphi(x, y)$ 在 $(0,0)$ 点连续，则 $\mathrm{d} f(x, y)=\left[\varphi(x, y)+(x+y) \varphi_{x}^{\prime}(x, y)\right] \mathrm{d} x+\left[\varphi(x, y)+(x+y) \varphi_{y}^{\prime}(x, y)\right] \mathrm{d} y$，令 $x=0, y=0, \mathrm{~d} f(0,0)=\varphi(0,0) \mathrm{d} x+\varphi(0,0) \mathrm{d} y$。

- (1) 指出错误；
- (2) 写出正确的解法。

**解**：
1. $\varphi(x, y)$ 仅在 $(0,0)$ 点连续，因此 $\varphi_{x}^{\prime}(x, y), \varphi_{y}^{\prime}(x, y)$ 未必存在，所以本题的做法是错的。
2. $f(0+\Delta x, 0+\Delta y)-f(0,0)=(\Delta x+\Delta y) \varphi(\Delta x, \Delta y)$。

因为 $\varphi(x, y)$ 在 $(0,0)$ 点连续，

$$
\varphi(\Delta x, \Delta y)=\varphi(0,0)+a(\Delta x, \Delta y)
$$

其中 $a(\Delta x, \Delta y)=o(1), \sqrt{(\Delta x)^{2}+(\Delta y)^{2}} \rightarrow 0$ 时（即 $\lim _{\substack{\Delta x \rightarrow 0 \\ \Delta y \rightarrow 0}}(\Delta x, \Delta y)=0$）。

故

$$
\begin{aligned}
f(\Delta x, \Delta y)-f(0,0) & =(\Delta x+\Delta y)[\varphi(0,0)+a(\Delta x, \Delta y)] \\
& =\varphi(0,0) \Delta x+\varphi(0,0) \Delta y+(\Delta x+\Delta y) a(\Delta x, \Delta y)
\end{aligned}
$$

而

$$
\lim _{\substack{\Delta y \rightarrow 0 \\ \Delta y \rightarrow 0}} \frac{(\Delta x+\Delta y) a(\Delta x, \Delta y)}{\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}}=0
$$

$(\Delta x+\Delta y) a(\Delta x, \Delta y)=o\left(\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}\right), \rho=\sqrt{(\Delta x)^{2}+(\Delta y)^{2}} \rightarrow 0$ 时，$f(x, y)$ 在 $(0,0)$ 点可微，且

$$
\mathrm{d} f(0,0)=\varphi(0,0) \mathrm{d} x+\varphi(0,0) \mathrm{d} y
$$

6. 函数 $f(x, y)=\sqrt{\|x y\|}$ 在 $(0,0)$ 点

- (A) 连续，但偏导不存在。
- (B) 偏导存在，但不可微。
- (C) 可微。
- (D) 上述 (A) (B) (C) 均不正确。

**解**：先讨论 $f(x, y)$ 在 $(0,0)$ 点的连续性。显然

$$
\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} f(x, y)=\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 0}} \sqrt{|x y|}=0=f(0,0)
$$

所以 $f(x, y)$ 在 $(0,0)$ 点连续。

再讨论 $f(x, y)$ 在 $(0,0)$ 点偏导的存在性。

$$
\begin{aligned}
& \lim _{\Delta x \rightarrow 0} \frac{f(0+\Delta x, 0)-f(0,0)}{\Delta x}=0 \\
& \lim _{\Delta y \rightarrow 0} \frac{f(0,0+\Delta y)-f(0,0)}{\Delta y}=0
\end{aligned}
$$

所以 $\left.\frac{\partial f}{\partial x}\right|_{(0,0)}=\left.\frac{\partial f}{\partial y}\right|_{(0,0)}=0$，存在。

最后讨论 $f(x, y)$ 在 $(0,0)$ 点的可微性。

$$
\lim _{\substack{\Delta x \rightarrow 0 \\ \Delta y \rightarrow 0}} \frac{f(0+\Delta x, 0+\Delta y)-f(0,0)-\left[\left.\frac{\partial f}{\partial x}\right|_{(0,0)} \Delta x+\left.\frac{\partial f}{\partial y}\right|_{(0,0)} \Delta y\right]}{\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}}=\lim _{\substack{\Delta x \rightarrow 0 \\ \Delta y \rightarrow 0}} \frac{\sqrt{|\Delta x||\Delta y|}}{\sqrt{(\Delta x)^{2}+(\Delta y)^{2}}}
$$

不存在，所以 $f(x, y)$ 在 $(0,0)$ 点不可微。

答案：(B)。

7. 设连续函数 $z=f(x, y)$ 满足 $\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 2}} \frac{f(x, y)-3 x+y-3}{\sqrt{x^{2}+(y-2)^{2}}}=0$，则 $\left.\mathrm{d} z\right|_{(0,2)}=$

**解**：$\lim _{\substack{x \rightarrow 0 \\ y \rightarrow 2}} \frac{f(x, y)-3 x+y-3}{\sqrt{x^{2}+(y-2)^{2}}}=0$ 以及 $z=f(x, y)$ 连续可得 $f(0,2)=1$，且

$$
f(x, y)-f(0,2)=3 x-(y-2)+o\left(\sqrt{x^{2}+(y-2)^{2}}\right)(x \rightarrow 0, y \rightarrow 2)
$$

由可微的定义得 $f_{x}^{\prime}(0,2)=3, f_{y}^{\prime}(0,2)=-1$，即

$$
\left.\mathrm{d} z\right|_{(0,2)}=f_{x}^{\prime}(0,2) \mathrm{d} x+f_{y}^{\prime}(0,2) \mathrm{d} y=3 \mathrm{~d} x-\mathrm{d} y
$$

应填 $3 \mathrm{~d} x-\mathrm{d} y$。

## 二、复合函数的偏导数与全微分

### 1. 复合函数求导法则

**定理（多元函数与一元函数的复合）**：
如果函数 $u=\varphi(t), v=\psi(t)$ 都在点 $t$ 可导，函数 $z=f(u, v)$ 在对应点 $(u, v)$ 具有连续一阶偏导数，则复合函数 $z=f[\varphi(t), \psi(t)]$ 在点 $t$ 可导，且

$$
\frac{\mathrm{d} z}{\mathrm{~d} t}=\frac{\partial z}{\partial u} \frac{\mathrm{~d} u}{\mathrm{~d} t}+\frac{\partial z}{\partial v} \frac{\mathrm{~d} v}{\mathrm{~d} t}
$$

**注释**：由于以上的函数 $z=f[\varphi(t), \psi(t)]$ 仅是 $t$ 的一元函数，则这里的 $\frac{\mathrm{d} z}{\mathrm{~d} t}$ 称为全导数。

**定理（多元函数与多元函数的复合）**：
如果函数 $u=\varphi(x, y), v=\psi(x, y)$ 在点 $(x, y)$ 有对 $x, y$ 的偏导数，函数 $z=f(u, v)$ 在对应点有连续一阶偏导数，则复合函数 $z=f[\varphi(x, y), \psi(x, y)]$ 在点 $(x, y)$ 有对 $x, y$ 的偏导数，且

$$
\frac{\partial z}{\partial x}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial x}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial x} \cdot \frac{\partial z}{\partial y}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial y}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial y}
$$

以上两定理所给出的复合函数求导法则是常用的重要法则，两个定理中给出的求导公式不必硬背，关键是要理解并掌握复合函数求导法则。通常先通过"树形图"分析清楚变量之间的关系，然后利用"树形图"就可写出导数公式，这种方法在解题中可自如地应用。

- 变量之间的树形图

通过"树形图"可清楚看出，谁是自变量，谁是中间变量，谁是谁的函数。出现在"树形图"各个树枝末端的变量为自变量。出现在树枝之间的变量为中间变量。

- 偏导数计算公式的结构

复合函数求导公式不难看出，等式右端往往是若干项之和，而每一项都是若干个导数之积，并且有以下规律：
1. 对某自变量导数的项数 = "树形图" 中各树枝末端出现该自变量的个数。
2. 各项中偏导乘积的因子数 = 因变量与树枝末端该自变量之间的树枝数。

8. 设 $z=f\left(x y, x^{2}-y^{2}\right)$，其中 $f$ 可微，$\frac{\partial z}{\partial x}=$

**解**：$z$ 是由 $f(u, v)$ 及 $\left\{\begin{array}{l}u=x y, \\ v=x^{2}-y^{2}\end{array}\right.$ 复合而成的函数，故

$$
\frac{\partial z}{\partial x}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial x}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial x}=y \frac{\partial f}{\partial u}+2 x \frac{\partial f}{\partial v}
$$

**评注**：$\frac{\partial f}{\partial u} \cdot \frac{\partial f}{\partial v}$ 经常记作 $f_{1}^{\prime}, f_{2}^{\prime}$。

### 2. 全微分形式不变性

设函数 $z=f(u, v)$ 和 $u=\varphi(x, y), v=\psi(x, y)$ 都具有连续一阶偏导数，则复合函数 $z=f[\varphi(x, y), \psi(x, y)]$ 可微，且

$$
\mathrm{d} z=\frac{\partial z}{\partial x} \mathrm{~d} x+\frac{\partial z}{\partial y} \mathrm{~d} y
$$

又 $\frac{\partial z}{\partial x}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial x}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial x} \cdot \frac{\partial z}{\partial y}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial y}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial y}$ 将 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$ 代入上式得

$$
\begin{aligned}
\mathrm{d} z & =\left(\frac{\partial f}{\partial u} \frac{\partial u}{\partial x}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial x}\right) \mathrm{d} x+\left(\frac{\partial f}{\partial u} \frac{\partial u}{\partial y}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial y}\right) \mathrm{d} y \\
& =\frac{\partial f}{\partial u}\left(\frac{\partial u}{\partial x} \mathrm{~d} x+\frac{\partial u}{\partial y} \mathrm{~d} y\right)+\frac{\partial f}{\partial v}\left(\frac{\partial v}{\partial x} \mathrm{~d} x+\frac{\partial v}{\partial y} \mathrm{~d} y\right) \\
& =\frac{\partial f}{\partial u} \mathrm{~d} u+\frac{\partial f}{\partial v} \mathrm{~d} v=\frac{\partial z}{\partial u} \mathrm{~d} u+\frac{\partial z}{\partial v} \mathrm{~d} v
\end{aligned}
$$

由此可见，无论是把 $z$ 看作自变量 $x$ 和 $y$ 的函数，还是把 $z$ 看作中间变量 $u$ 和 $v$ 的函数，它的微分 $\mathrm{d} z=\frac{\partial z}{\partial x} \mathrm{~d} x+\frac{\partial z}{\partial y} \mathrm{~d} y$ 和 $\mathrm{d} z=\frac{\partial z}{\partial u} \mathrm{~d} u+\frac{\partial z}{\partial v} \mathrm{~d} v$ 具有同样的形式。这个性质叫全微分形式不变性。

### 3. 高阶偏导数

**定义**：设函数 $z=f(x, y)$ 在区域 $D$ 内具有偏导数，

$$
\frac{\partial z}{\partial x}=f_{x}^{\prime}(x, y), \quad \frac{\partial z}{\partial y}=f_{y}^{\prime}(x, y)
$$

如果 $f_{x}^{\prime}(x, y)$ 和 $f_{y}^{\prime}(x, y)$ 的偏导数也存在，则称它们是函数 $z=f(x, y)$ 的二阶导数。二阶导数有以下四个

$$
\begin{aligned}
& \frac{\partial^{2} z}{\partial x^{2}}=\frac{\partial}{\partial x}\left(\frac{\partial z}{\partial x}\right)=f_{x x}^{\prime \prime}(x, y), \quad \frac{\partial^{2} z}{\partial x \partial y}=\frac{\partial}{\partial y}\left(\frac{\partial z}{\partial x}\right)=f_{x y}^{\prime \prime}(x, y) \\
& \frac{\partial^{2} z}{\partial y \partial x}=\frac{\partial}{\partial x}\left(\frac{\partial z}{\partial y}\right)=f_{y y}^{\prime \prime}(x, y), \quad \frac{\partial^{2} z}{\partial y^{2}}=\frac{\partial}{\partial y}\left(\frac{\partial z}{\partial y}\right)=f_{y y}^{\prime \prime}(x, y)
\end{aligned}
$$

其中 $\frac{\partial^{2} z}{\partial x \partial y}$ 和 $\frac{\partial^{2} z}{\partial y \partial x}$ 称为混合偏导数。类似地可得到三阶、四阶、$\cdots, n$ 阶偏导数，二阶及二阶以上的偏导数统称为高阶偏导数。

**定理**：若函数 $z=f(x, y)$ 的两个混合偏导数 $\frac{\partial^{2} z}{\partial x \partial y}$ 和 $\frac{\partial^{2} z}{\partial y \partial x}$ 在点 $\left(x_{0}, y_{0}\right)$ 都连续，则在 $\left(x_{0}, y_{0}\right)$ 点 $\frac{\partial^{2} z}{\partial x \partial y}=\frac{\partial^{2} z}{\partial y \partial x}$。

119. 设 $z=\frac{y}{x}+x y f\left(\frac{y}{x}\right), f$ 二阶可微，则 $\frac{\partial^{2} z}{\partial y \partial x}=$

**解**：$\frac{\partial z}{\partial y}=\frac{1}{x}+x f\left(\frac{y}{x}\right)+x y f^{\prime}\left(\frac{y}{x}\right) \cdot \frac{1}{x}$

$$
\begin{aligned}
& =\frac{1}{x}+x f\left(\frac{y}{x}\right)+y f^{\prime}\left(\frac{y}{x}\right) \\
\frac{\partial^{2} z}{\partial y \partial x} & =\frac{\partial}{\partial x}\left(\frac{\partial z}{\partial y}\right)=\frac{\partial}{\partial x}\left[\frac{1}{x}+x f\left(\frac{y}{x}\right)+y f^{\prime}\left(\frac{y}{x}\right)\right] \\
& =-\frac{1}{x^{2}}+f\left(\frac{y}{x}\right)-\frac{y}{x} f^{\prime}\left(\frac{y}{x}\right)-\frac{y^{2}}{x^{2}} f^{\prime \prime}\left(\frac{y}{x}\right)
\end{aligned}

1110. 设函数 $F(x, y)=\int_{0}^{x y} \frac{\sin t}{1+t^{2}} \mathrm{~d} t$，则 $\left.\frac{\partial^{2} F}{\partial x^{2}}\right|_{\substack{x=0 \\ y=0}}=$

**解**：方法一 $\frac{\partial F}{\partial x}=\frac{y \sin x y}{1+x^{2} y^{2}}$，

$$
\frac{\partial^{2} F}{\partial x^{2}}=\frac{y^{2} \cos (x y)\left(1+x^{2} y^{2}\right)-2 x y^{3} \sin x y}{\left(1+x^{2} y^{2}\right)^{2}}
$$

故 $\left.\frac{\partial^{2} F}{\partial x^{2}}\right|_{\substack{x=0 \\ y=0}}=4$。

方法二 $\frac{\partial F}{\partial x}=\frac{y \sin x y}{1+x^{2} y^{2}}$，$F_{x}^{\prime}(x, 2)=\frac{2 \sin 2 x}{1+4 x^{2}}$，

$$
\left.\frac{\partial^{2} F}{\partial x^{2}}\right|_{\substack{x=0 \\ y=2}}=F_{x x}^{\prime \prime}(0,2)=\lim _{x \rightarrow 0} \frac{2 \sin 2 x}{x\left(1+4 x^{2}\right)}=\lim _{x \rightarrow 0} \frac{4 x}{x\left(1+4 x^{2}\right)}=4
$$

1111. 设 $\mu=\mathrm{e}^{-x} \sin \frac{x}{y}$，则 $\frac{\partial^{2} \mu}{\partial x \partial y}$ 在点 $\left(2, \frac{1}{\pi}\right)$ 处的值为

**解**：$\frac{\partial \mu}{\partial x}=-\mathrm{e}^{-x} \sin \frac{x}{y}+\frac{1}{y} \mathrm{e}^{-x} \cos \frac{x}{y}$

$$
=\mathrm{e}^{-x}\left(\frac{1}{y} \cos \frac{x}{y}-\sin \frac{x}{y}\right)
$$

$\left.\frac{\partial^{2} \mu}{\partial x \partial y}=e^{-x}\left(-\frac{1}{y^{2}} \cos \frac{x}{y}+\frac{x}{y^{2}} \sin \frac{x}{y}+\frac{x}{y^{2}} \cos \frac{x}{y}\right)\right.$，

因而 $\left.\frac{\partial^{2} \mu}{\partial x \partial y}\right|_{\left(1, \frac{1}{x}\right)}=\mathrm{e}^{-2}\left(-\pi^{2} \cos 2 \pi+2 \pi^{3} \sin 2 \pi+2 \pi^{2} \cos 2 \pi\right)=\pi^{2} \mathrm{e}^{-2}$。


## 三、隐函数的偏导数与全微分

1. **由一个方程式确定的隐函数（一元函数）求导法**

设 $F(x, y)$ 有连续一阶偏导数，且 $F_{y}^{\prime} \neq 0$，则由方程 $F(x, y)=0$ 确定的函数 $y=y(x)$ 可导，且

$$
\frac{\mathrm{d} y}{\mathrm{~d} x}=-\frac{F_{x}^{\prime}}{F_{y}^{\prime}}
$$

2. **由一个方程式确定的隐函数（二元函数）求导法**

设 $F(x, y, z)$ 有连续一阶偏导数，且 $F_{z}^{\prime} \neq 0$，$z=z(x, y)$ 由方程 $F(x, y, z)=0$ 所确定，则

$$
\frac{\partial z}{\partial x}=-\frac{F_{x}^{\prime}}{F_{z}^{\prime}}, \quad \frac{\partial z}{\partial y}=-\frac{F_{y}^{\prime}}{F_{z}^{\prime}}
$$

3. **由方程组所确定的隐函数（一元函数）求导法**

设 $u=u(x), v=v(x)$ 由方程组 $\left\{\begin{array}{l}F(x, u, v)=0 \\ G(x, u, v)=0\end{array}\right.$ 所确定，要求 $\frac{\mathrm{d} u}{\mathrm{~d} x}$ 和 $\frac{\mathrm{d} v}{\mathrm{~d} x}$，可通过原方程组两端对 $x$ 求导得到，即

$$
\left\{\begin{array}{l}
F_{x}^{\prime}+F_{u}^{\prime} \frac{\mathrm{d} u}{\mathrm{~d} x}+F_{v}^{\prime} \frac{\mathrm{d} v}{\mathrm{~d} x}=0 \\
G_{x}^{\prime}+G_{u}^{\prime} \frac{\mathrm{d} u}{\mathrm{~d} x}+G_{v}^{\prime} \frac{\mathrm{d} v}{\mathrm{~d} x}=0
\end{array}\right.
$$

然后从以上方程组中解出 $\frac{\mathrm{d} u}{\mathrm{~d} x}$ 和 $\frac{\mathrm{d} v}{\mathrm{~d} x}$。

4. **由方程组所确定的隐函数（二元函数）求导法**

设 $u=u(x, y), v=v(x, y)$ 由方程组 $\left\{\begin{array}{l}F(x, y, u, v)=0 \\ G(x, y, u, v)=0\end{array}\right.$ 所确定，若要求 $\frac{\partial u}{\partial x}$ 和 $\frac{\partial v}{\partial x}$，可先对原方程组两端对 $x$ 求偏导得到，即

$$
\left\{\begin{array}{l}
F_{x}^{\prime}+F_{u}^{\prime} \frac{\partial u}{\partial x}+F_{v}^{\prime} \frac{\partial v}{\partial x}=0 \\
G_{x}^{\prime}+G_{u}^{\prime} \frac{\partial u}{\partial x}+G_{v}^{\prime} \frac{\partial v}{\partial x}=0
\end{array}\right.
$$

然后从中解出 $\frac{\partial u}{\partial x}$ 和 $\frac{\partial v}{\partial x}$，同理可求得 $\frac{\partial u}{\partial y}$ 和 $\frac{\partial v}{\partial y}$。

**例题**：
12. 设函数 $z=z(x, y)$ 由方程 $x y z+\sqrt{x^{2}+y^{2}+z^{2}}=\sqrt{2}$ 确定，求 $z(x, y)$ 在 $(1,0,-1)$ 点处的全微分。

**解**：方法一 $F(x, y, z)=x y z+\sqrt{x^{2}+y^{2}+z^{2}}-\sqrt{2}$，

$$
\frac{\partial z}{\partial x}=-\frac{\frac{\partial F}{\partial x}}{\frac{\partial F}{\partial z}}=-\frac{y z+\frac{x}{\sqrt{x^{2}+y^{2}+z^{2}}}}{x y+\frac{z}{\sqrt{x^{2}+y^{2}+z^{2}}}}
$$

在 $x=1, y=0, z=-1$ 点，$\frac{\partial z}{\partial x}=1$。同样，在该点，$\frac{\partial z}{\partial y}=-\sqrt{2}$，所以在该点

$$
\mathrm{d} z=\mathrm{d} x-\sqrt{2} \mathrm{~d} y
$$

方法二 因为 $z=z(x, y)$ 是由方程 $x y z+\sqrt{x^{2}+y^{2}+z^{2}}=\sqrt{2}$ 确定的函数，所以 $\forall(x, y)$，

$$
x y z(x, y)+\sqrt{x^{2}+y^{2}+z^{2}(x, y)} \equiv \sqrt{2}
$$

两边对 $x$ 求偏导

$$
y z+x y \frac{\partial z}{\partial x}+\frac{x}{\sqrt{x^{2}+y^{2}+z^{2}}}+\frac{z}{\sqrt{x^{2}+y^{2}+z^{2}}} \frac{\partial z}{\partial x}=0
$$

将 $x=1, y=0, z=-1$ 代入

$$
\left.\frac{\partial z}{\partial x}\right|_{(1,0)}=1
$$

同理，两边对 $y$ 求偏导，将 $x=1, y=0, z=-1$ 代入可求得 $\left.\frac{\partial z}{\partial y}\right|_{(1,0)}=-\sqrt{2}$。因此 $\mathrm{d} z=\mathrm{d} x-\sqrt{2} \mathrm{~d} y$。

**评注**：可利用方程两边求微分的方法求得全微分。

13. 若函数 $z=z(x, y)$ 由方程 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 确定，则 $\left.\mathrm{d} z\right|_{(0,0)}=$

**解**：方法一 将 $x=0, y=0$ 代入 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 中得 $\mathrm{e}^{3 x}=1$，则 $z=0$。方程 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 两端微分得

$$
\mathrm{e}^{z+2 y+3 x}(\mathrm{~d} x+2 \mathrm{~d} y+3 \mathrm{~d} z)+y z \mathrm{~d} x+x z \mathrm{~d} y+x y \mathrm{~d} z=0
$$

将 $x=0, y=0, z=0$ 代入上式得

$$
\mathrm{d} x+2 \mathrm{~d} y+3 \mathrm{~d} z=0
$$

则 $\left.\mathrm{d} z\right|_{(0,0)}=-\frac{1}{3}(\mathrm{~d} x+2 \mathrm{~d} y)$。

方法二 将 $x=0, y=0$ 代入 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 得 $\mathrm{e}^{3 x}=1$，则 $z=0$，

$$
\left.\mathrm{d} z\right|_{(0,0)}=z_{x}^{\prime}(0,0) \mathrm{d} x+z_{y}^{\prime}(0,0) \mathrm{d} y
$$

在 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 中令 $y=0, \mathrm{e}^{z+3 x}=1$。两边对 $x$ 求导得

$$
\begin{aligned}
& \mathrm{e}^{z+3 x}\left(1+3 z_{x}^{\prime}\right)=0 \\
& z_{x}^{\prime}(0,0)=-\frac{1}{3}
\end{aligned}
$$

在 $\mathrm{e}^{z+2 y+3 x}+x y z=1$ 中令 $x=0$ 得，$\mathrm{e}^{2 y+3 x}=1$。两边对 $y$ 求导得

$$
\begin{aligned}
& \mathrm{e}^{2 y+3 x}\left(2+3 z_{y}^{\prime}\right)=0 \\
& z_{y}^{\prime}(0,0)=-\frac{2}{3}
\end{aligned}
$$

则 $\left.\mathrm{d} z\right|_{(0,0)}=-\frac{1}{3}(\mathrm{~d} x+2 \mathrm{~d} y)$。

14. 设函数 $z=z(x, y)$ 由参数方程 $\left\{\begin{array}{l}x=u \cos v, \\ y=u \sin v, \text { 给出, 求 } \frac{\partial z}{\partial x} . \\ z=u v\end{array}\right.$

**解**：$z$ 是 $u, v$ 的函数，而由 $\left\{\begin{array}{l}x=u \cos v, \\ y=u \sin v\end{array}\right.$ 可得 $u, v$ 是 $x, y$ 的函数，因此 $z$ 是复合函数 $z$ $=u(x, y) \cdot v(x, y)$，

$$
\frac{\partial z}{\partial x}=v \frac{\partial u}{\partial x}+u \frac{\partial v}{\partial x}
$$

只要求出 $\frac{\partial u}{\partial x}, \frac{\partial v}{\partial x}$ 即可。

两个方程都对 $x$ 求偏导：

$$
\left\{\begin{array}{l}
x-u \cos v=0 \\
y-u \sin v=0
\end{array}\right.
$$

$$
\left\{\begin{array}{l}
1-\frac{\partial u}{\partial x} \cos v+u \sin v \frac{\partial v}{\partial x}=0 \\
0-\frac{\partial u}{\partial x} \sin v-u \cos v \frac{\partial v}{\partial x}=0
\end{array}\right.
$$

将 $\frac{\partial u}{\partial x}, \frac{\partial v}{\partial x}$ 看成未知数，解上述线性非齐次代数方程可得：

故

$$
\begin{gathered}
\frac{\partial u}{\partial x}=\cos v, \frac{\partial v}{\partial x}=-\frac{\sin v}{u} \\
\frac{\partial z}{\partial x}=v \cos v-\sin v
\end{gathered}
$$

15. 设 $z=f(x+y, x-y), f(x, y)$ 二阶偏导连续，则 $\frac{\partial^{2} z}{\partial x \partial y}=$

**解**：记 $u=x+y, v=x-y$，则 $z=f(u, v)$。

$
\begin{aligned}
& \frac{\partial z}{\partial y}=\frac{\partial f}{\partial u} \frac{\partial u}{\partial y}+\frac{\partial f}{\partial v} \frac{\partial v}{\partial y}=f_{u}^{\prime}-f_{v}^{\prime} \\
\frac{\partial^{2} z}{\partial x \partial y} & =\frac{\partial}{\partial x}\left(\frac{\partial z}{\partial y}\right)=\frac{\partial}{\partial x}\left[f_{u}^{\prime}(u, v)-f_{v}^{\prime}(u, v)\right] \\
& =\frac{\partial}{\partial x}\left[f_{u}^{\prime}(u, v)\right]-\frac{\partial}{\partial x}\left[f_{v}^{\prime}(u, v)\right] \\
& =f_{u u}^{\prime \prime}+f_{u v}^{\prime \prime}-f_{v u}^{\prime \prime}-f_{v u}^{\prime \prime}
\end{aligned}
$

$$
=f_{u u}^{\prime \prime}-f_{v u}^{\prime \prime}
$$

因为 $f$ 为二阶偏导连续的函数，所以 $f_{u u}^{\prime \prime}=f_{v u}^{\prime \prime}$，$\frac{\partial^{2} z}{\partial x \partial y}=f_{u u}^{\prime \prime}-f_{v u}^{\prime \prime}$。

# 第三节 极值与最值

## 一、无条件极值

**定义**：若存在 $M_{0}\left(x_{0}, y_{0}\right)$ 点的某邻域 $U_{\delta}\left(M_{0}\right)$，使得

$$
f(x, y) \leqslant f\left(x_{0}, y_{0}\right)\left(\text { 或 } f(x, y) \geqslant f\left(x_{0}, y_{0}\right)\right), \forall(x, y) \in U_{\delta}\left(M_{0}\right)
$$

则称 $f(x, y)$ 在点 $M_{0}\left(x_{0}, y_{0}\right)$ 取得极大值（极小值） $f\left(x_{0}, y_{0}\right)$，极大值与极小值统称为极值。

点 $M_{0}\left(x_{0}, y_{0}\right)$ 称为 $f(x, y)$ 的极值点。

**常理（各处函数取得极值的必要条件）**：设函数 $f(x, y)$ 在点 $M_{0}\left(x_{0}, y_{0}\right)$ 的一阶偏导数存在，且在 $\left(x_{0}, y_{0}\right)$ 取得极值，则

$$
f_{x}^{\prime}\left(x_{0}, y_{0}\right)=0, \quad f_{y}^{\prime}\left(x_{0}, y_{0}\right)=0
$$

**定义**：凡能使 $f_{x}^{\prime}(x, y)=0, f_{y}^{\prime}(x, y)=0$ 同时成立的点 $(x, y)$ 称为函数 $f(x, y)$ 的驻点。

由此可见具有一阶偏导数的函数的极值点一定是驻点，但驻点不一定是极值点。

**常理（各处函数取得极值的充分条件）**：设函数 $z=f(x, y)$ 在点 $\left(x_{0}, y_{0}\right)$ 的某邻域内有连续的二阶偏导数，且 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)=0, f_{y}^{\prime}\left(x_{0}, y_{0}\right)=0$。

令 $f_{x x}^{\prime \prime}\left(x_{0}, y_{0}\right)=A, f_{x y}^{\prime \prime}\left(x_{0}, y_{0}\right)=B, f_{y y}^{\prime \prime}\left(x_{0}, y_{0}\right)=C$，则
1. $A C-B^{2}>0$ 时，$f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 取极值 $\left\{\begin{array}{l}\text { 当 } A>0 \text { 时取极小值, } \\ \text { 当 } A<0 \text { 时取极大值. }\end{array}\right.$
2. $A C-B^{2}<0$ 时，$f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 无极值。
3. $A C-B^{2}=0$ 时，不能确定 $f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 是否有极值，还需进一步讨论（一般用极值定义）。

**注释**：多元函数极值和最值与一元函数有很多类似的地方，但也有不同之处，因此我们不仅要注意到它们的共同之处，还要注意不同点。

**例题**：
1. $f(x, y)=x^{3}-3 x+y^{3}-3 y$ 的极大值点为 $\qquad$，极小值点为 $\qquad$。

**解**：$\left\{\begin{array}{l}\frac{\partial f}{\partial x}=3 x^{2}-3=0, \\ \frac{\partial f}{\partial y}=3 y^{2}-3=0\end{array}\right.$ 解得驻点为 $(1,1),(1,-1),(-1,1),(-1,-1)$。

$$
\begin{aligned}
& A=\frac{\partial^{2} f}{\partial x^{2}}=6 x, \\
& B=\frac{\partial^{2} f}{\partial x \partial y}=0, \\
& C=\frac{\partial^{2} f}{\partial y^{2}}=6 y,
\end{aligned}
$$

在 $(1,1),(-1,-1)$ 点，$A C-B^{2}>0$，在 $(1,1)$ 点 $A>0$，在 $(-1,-1)$ 点 $A<0$。因此极大值点为 $(-1,-1)$，极小值点为 $(1,1)$。

2. 设 $z=z(x, y)$ 由 $2 x^{2}+2 y^{2}+z^{2}+8 x z-z+8=0$ 确定，求该函数的极值。

**解**：$4 x \mathrm{~d} x+4 y \mathrm{~d} y+2 z \mathrm{~d} z+8 x \mathrm{~d} z+8 z \mathrm{~d} x-\mathrm{d} z=0$，

$$
\begin{gathered}
\mathrm{d} z=-\frac{4 x+8 z}{2 z+8 x-1} \mathrm{~d} x-\frac{4 y}{2 z+8 x-1} \mathrm{~d} y \\
\frac{\partial z}{\partial x}=-\frac{4 x+8 z}{2 z+8 x-1}=0 \\
\frac{\partial z}{\partial y}=-\frac{4 y}{2 z+8 x-1}=0 \\
2 x^{2}+2 y^{2}+z^{2}+8 x z-z+8=0
\end{gathered}
$$

三个方程联立，得驻点 $(-2,0),\left(\frac{16}{7}, 0\right)$。

在 $(-2,0)$ 点

$$
z_{x x}^{\prime \prime}(-2,0) z_{x x}^{\prime \prime}(-2,0)-\left[z_{x x}^{\prime \prime}(-2,0)\right]^{2}=\frac{16}{225}>0
$$

且 $z_{x x}^{\prime \prime}(-2,0)=\frac{4}{15}>0$，$(-2,0)$ 点是极小值点；

在 $\left(\frac{16}{7}, 0\right)$ 点

$$
z_{x x}^{\prime \prime}\left(\frac{16}{7}, 0\right) z_{x x}^{\prime \prime}\left(\frac{16}{7}, 0\right)-\left[z_{x x}^{\prime \prime}\left(\frac{16}{7}, 0\right)\right]^{2}=\frac{16}{225}>0
$$

且 $z_{x x}^{\prime \prime}\left(\frac{16}{7}, 0\right)=-\frac{4}{15}<0$，$\left(\frac{16}{7}, 0\right)$ 点是极大值点。

**评注**：本题考查隐函数的极值。

3. 设函数 $z=f(x, y)$ 的全微分为 $\mathrm{d} z=2 x \mathrm{~d} x+y \mathrm{~d} y$，则点 $(0,0)$

- (A) 不是 $f(x, y)$ 的连续点。
- (B) 不是 $f(x, y)$ 的极值点。
- (C) 是 $f(x, y)$ 的极大值点。
- (D) 是 $f(x, y)$ 的极小值点。

**解**：因 $\mathrm{d} z=2 x \mathrm{~d} x+y \mathrm{~d} y$，可得 $\frac{\partial z}{\partial x}=2 x, \frac{\partial z}{\partial y}=y$，

$$
A=\frac{\partial^{2} z}{\partial x^{2}}=2, B=\frac{\partial^{2} z}{\partial x \partial y}=\frac{\partial^{2} z}{\partial y \partial x}=0, C=\frac{\partial^{2} z}{\partial y^{2}}=1
$$

又在 $(0,0)$ 处，$\frac{\partial z}{\partial x}=0, \frac{\partial z}{\partial y}=0, A C-B^{2}=2>0$，故 $(0,0)$ 为函数 $z=f(x, y)$ 的一个极小值点。答案应选 $(\mathrm{D})$。

4. 设可微函数 $f(x, y)$ 在点 $\left(x_{0}, y_{0}\right)$ 取得极小值，则下列结论正确的是

- (A) $f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数等于零。
- (B) $f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数大于零。
- (C) $f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数小于零。
- (D) $f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数不存在。

**分析**：可微必有偏导数存在，再根据取极值的必要条件即可得结论。

**解**：可微函数 $f(x, y)$ 在点 $\left(x_{0}, y_{0}\right)$ 取得极小值，根据取极值的必要条件知 $f^{\prime}{ }_{y}\left(x_{0}\right.$, $\left.y_{0}\right)=0$，即 $f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数等于零。故应选 $(\mathrm{A})$。

**评注**：
1. 本题考查了偏导数的定义，$f\left(x_{0}, y\right)$ 在 $y=y_{0}$ 处的导数即 $f_{y}^{\prime}\left(x_{0}, y_{0}\right)$；而 $f\left(x, y_{0}\right)$ 在 $x=x_{0}$ 处的导数即 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)$。
2. 本题也可用排除法分析，取 $f(x, y)=x^{2}+y^{2}$，在 $(0,0)$ 处可微且取得极小值，并且有 $f(0, y)=y^{2}$，可排除 $(\mathrm{B})(\mathrm{C})(\mathrm{D})$。故正确选项为 $(\mathrm{A})$。

## 二、条件极值

1. 函数 $f(x, y)$ 在条件 $\varphi(x, y)=0$ 下的极值

解决此类问题的一般方法是拉格朗日乘数法：先构造拉格朗日函数 $F(x, y, \lambda)=f(x, y)+\lambda \varphi(x, y)$，然后解方程组

$$
\left\{\begin{array}{l}
\frac{\partial F}{\partial x}=\frac{\partial f}{\partial x}+\lambda \frac{\partial \varphi}{\partial x}=0 \\
\frac{\partial F}{\partial y}=\frac{\partial f}{\partial y}+\lambda \frac{\partial \varphi}{\partial y}=0 \\
\frac{\partial F}{\partial \lambda}=\varphi(x, y)=0
\end{array}\right.
$$

所有满足此方程组的解 $(x, y, \lambda)$ 中 $(x, y)$ 是函数 $f(x, y)$ 在条件 $\varphi(x, y)=0$ 下的可能的极值点。

2. 函数 $f(x, y, z)$ 在条件 $\varphi(x, y, z)=0, \psi(x, y, z)=0$ 下的极值

与上一条情况类似，构造拉格朗日函数

$$
F(x, y, z, \lambda, \mu)=f(x, y, z)+\lambda \varphi(x, y, z)+\mu \psi(x, y, z)
$$

以下与上一条情况类似（略）。

## 三、最值问题

这里有两种问题，一种是求连续函数 $f(x, y)$ 在有界闭区域 $D$ 上的最值，此类问题分以下三步进行：
1. 求出 $f(x, y)$ 在 $D$ 内可能取得极值点（驻点和一阶偏导不存在的点）的函数值。
2. 求出 $f(x, y)$ 在 $D$ 的边界上的最大、最小值。
3. 将上面求得的 $D$ 内可能取得极值点上的函数值与 $D$ 的边界上的最值进行比较，最大（小）者为最大（小）值。

另外一种问题是最大最小值的应用题，此类问题首先建立目标函数，这样就把该问题化为第一种问题，而对于应用问题，如果 $f(x, y)$ 可能取得极值的点只有一个，并根据问题本身知道所求最值存在，则可断言所求最值就在这个唯一可能取得极值的点上取得。

5. 求原点到曲面 $z^{2}=x y+x-y+4$ 的最短距离。

**解**：拉格朗日函数：$L=x^{2}+y^{2}+z^{2}+\lambda\left(z^{2}-x y-x+y-4\right)$，

$$
\left\{\begin{array}{l}
L_{x}^{\prime}=2 x-\lambda(y+1)=0 \\
L_{y}^{\prime}=2 y+\lambda(-x+1)=0 \\
L_{z}^{\prime}=2 z+2 \lambda z=0 \\
L_{x}^{\prime}=z^{2}-x y-x+y-4=0
\end{array}\right.
$$

解方程组，$x=-1, y=1, z= \pm 1 . x=1 \pm \sqrt{5}, y=-(1 \pm \sqrt{5}), z=0$ 拉格朗日函数的四个驻点为

$$
P_{1}(-1,1,1), P_{2}(-1,1,-1), P_{3}(1+\sqrt{5},-(1+\sqrt{5}), 0), P_{4}(1-\sqrt{5},-(1-\sqrt{5}), 0)
$$

距离 $d\left(P_{1}\right)=d\left(P_{2}\right)=\sqrt{3}, d\left(P_{3}\right)=\sqrt{12+4 \sqrt{5}}, d\left(P_{4}\right)=\sqrt{12-4 \sqrt{5}}$，由实际意义，本问题存在最短距离，故 $\sqrt{3}$ 就是最短距离。

6. 在平面直角坐标系中已知三点 $P_{1}(0,0), P_{2}(1,0), P_{3}(0,1)$，试在 $\triangle P_{1} P_{2} P_{3}$ 围成的闭区域 $\bar{D}$ 找点 $P(x, y)$，使得 $P$ 到 $P_{1}, P_{2}, P_{3}$ 点的距离平方和为最大和最小。



$$
\begin{aligned}
f(x, y) & =\left|P P_{1}\right|^{2}+\left|P P_{2}\right|^{2}+\left|P P_{3}\right|^{2} \\
& =x^{2}+y^{2}+(x-1)^{2}+y^{2}+x^{2}+(y-1)^{2} \\
& =3 x^{2}+3 y^{2}-2 x-2 y+2
\end{aligned}
$$

（1）若最值点发生在 $\triangle P_{1} P_{2} P_{3}$ 的内部，则一定是极值点，先求 $f(x, y)$ 在 $\triangle P_{1} P_{2} P_{3}$ 内部的驻点。

$$
\left\{\begin{array}{l}
\frac{\partial f}{\partial x}=6 x-2=0 \\
\frac{\partial f}{\partial y}=6 y-2=0
\end{array}\right.
$$

唯一驻点为 $Q_{1}\left(\frac{1}{3}, \frac{1}{3}\right)$。可以验证 $Q_{1}$ 点在 $\triangle P_{1} P_{2} P_{3}$ 内部。

（2）若最值点发生在边界 $P_{1} P_{2}$ 上，则一定是条件极值的极值点。构造拉格朗日函数

$$
\begin{aligned}
F_{1}(x, y, \lambda) & =3 x^{2}+3 y^{2}-2 x-2 y+2+\lambda y \\
\therefore \quad\left\{\begin{array}{l}
\frac{\partial F_{1}}{\partial x}=6 x-2=0 \\
\frac{\partial F_{1}}{\partial y}=6 y-2+\lambda=0 \\
\frac{\partial F_{1}}{\partial \lambda}=y=0
\end{array}\right.
\end{aligned}
$$

解得驻点 $Q_{2}\left(\frac{1}{3}, 0\right)$，可以验证 $Q_{2}$ 在边界 $P_{1} P_{3}$ 上。

（3）若最值点发生在边界 $P_{1} P_{3}, P_{2} P_{3}$ 上，同样可以构造拉格朗日函数

$$
\begin{gathered}
F_{3}(x, y, \lambda)=3 x^{2}+3 y^{2}-2 x-2 y+2+\lambda x \\
F_{3}(x, y, \lambda)=3 x^{2}+3 y^{2}-2 x-2 y+2+\lambda(x+y-1)
\end{gathered}
$$

求得驻点 $Q_{3}\left(0, \frac{1}{3}\right), Q_{4}\left(\frac{1}{2}, \frac{1}{2}\right)$，可以验证 $Q_{3}$ 在边界 $P_{1} P_{3}$ 上，$Q_{4}$ 在边界 $P_{2} P_{3}$ 上。

（4）除此之外，还有三个点要考虑：$P_{1}, P_{2}, P_{3}$。

求出 $f$ 在这些点的值：

$$
\begin{gathered}
f\left(Q_{1}\right)=\frac{4}{3}, f\left(Q_{2}\right)=\frac{5}{3}, f\left(Q_{3}\right)=\frac{5}{3}, f\left(Q_{4}\right)=\frac{3}{2} \\
f\left(P_{1}\right)=2, f\left(P_{2}\right)=3, f\left(P_{3}\right)=3
\end{gathered}
$$

因为 $f(x, y)$ 是连续函数，$\bar{D}$ 为有界闭区域，$f(x, y)$ 在 $\bar{D}$ 上一定有最大值和最小值，上述七个函数值中最大的就是最大值，最小的就是最小值，所以 $f(x, y)$ 在 $\bar{D}$ 上的最大值为 3，最小值为 $\frac{4}{3}$。

**评注**：对于简单的边界（例如本题中的边界）通过解出边界方程，将条件极值问题转化成无条件极值问题。例如，在边界 $P_{2} P_{3}$ 上，$x+y=1$。解出 $y=1-x$，代入 $f(x, y)$ 的表达式，得

$$
g(x)=f(x, 1-x)=3 x^{2}+3(1-x)^{2}-2 x-2(1-x)+2
$$

条件极值问题可以转化成 $g(x)$ 函数在 $(0,1)$ 内的无条件极值问题，这样就不用通过拉格朗日函数来求驻点了。

7. 设 $f(x, y)$ 与 $\varphi(x, y)$ 均为可微函数，且 $\varphi_{x}^{\prime}(x, y) \neq 0$，已知 $\left(x_{0}, y_{0}\right)$ 是 $f(x, y)$ 在约束条件 $\varphi(x, y)=0$ 下的一个极值点。下列选项正确的是

- (A) 若 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)=0$，则 $f_{y}^{\prime}\left(x_{0}, y_{0}\right)=0$。
- (B) 若 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)=0$，则 $f_{y}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$。
- (C) 若 $f_{x}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$，则 $f_{y}^{\prime}\left(x_{0}, y_{0}\right)=0$。
- (D) 若 $f_{x}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$，则 $f_{y}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$。

**解**：作拉格朗日函数 $F(x, y, \lambda)=f(x, y)+\lambda \varphi(x, y)$，并记对应 $x_{0}, y_{0}$ 的参数 $\lambda$ 的值为 $\lambda_{0}$，则

$$
\left\{\begin{array}{l}
F_{x}^{\prime}\left(x_{0}, y_{0}, \lambda_{0}\right)=0, \\
F_{y}^{\prime}\left(x_{0}, y_{0}, \lambda_{0}\right)=0,
\end{array}\right.
\left\{\begin{array}{l}
f_{x}^{\prime}\left(x_{0}, y_{0}\right)+\lambda_{0} \varphi_{x}^{\prime}\left(x_{0}, y_{0}\right)=0 \\
f_{y}^{\prime}\left(x_{0}, y_{0}\right)+\lambda_{0} \varphi_{y}^{\prime}\left(x_{0}, y_{0}\right)=0
\end{array}\right.
$$

消去 $\lambda_{0}$，得

$$
f_{x}^{\prime}\left(x_{0}, y_{0}\right) \varphi_{y}^{\prime}\left(x_{0}, y_{0}\right)-f_{y}^{\prime}\left(x_{0}, y_{0}\right) \varphi_{x}^{\prime}\left(x_{0}, y_{0}\right)=0
$$

整理得 $f_{x}^{\prime}\left(x_{0}, y_{0}\right)=\frac{1}{\varphi_{y}^{\prime}\left(x_{0}, y_{0}\right)} f_{y}^{\prime}\left(x_{0}, y_{0}\right) \varphi_{x}^{\prime}\left(x_{0}, y_{0}\right)$（因为 $\varphi_{y}^{\prime}(x, y) \neq 0$）。

若 $f_{x}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$，则 $f_{y}^{\prime}\left(x_{0}, y_{0}\right) \neq 0$。

故本题答案选 (D)。

**评注**：本题考查了二元函数极值的必要条件和拉格朗日乘数法。

8. 求函数 $f(x, y)=x^{2}+2 y^{2}-x^{2} y^{2}$ 在区域 $D=\left\{(x, y) \mid x^{2}+y^{2} \leqslant 4, y \geqslant 0\right\}$ 上的最大值和最小值。

**解**：函数在区域 $D=\left\{(x, y) \mid x^{2}+y^{2}<4, y>0\right\}$ 内的驻点，

$$
\left\{\begin{array}{l}
f_{x}^{\prime}=2 x-2 x y^{2}=0 \\
f_{y}^{\prime}=4 y-2 x^{2} y=0
\end{array}\right.
$$

解得 $\left\{\begin{array}{l}x= \pm \sqrt{2} \\ y=1\end{array}\right.$，相应的函数值 $f( \pm \sqrt{2}, 1)=2$。

函数在边界 $y=0(-2 \leqslant x \leqslant 2)$，

$$
f(x, 0)=x^{2},-2 \leqslant x \leqslant 2
$$

最大值 $f( \pm 2,0)=4$，最小值 $f(0,0)=0$。

函数在边界 $x^{2}+y^{2}=4, y>0$。作拉格朗日函数

$$
L(x, y)=x^{2}+2 y^{2}-x^{2} y^{2}+\lambda\left(x^{2}+y^{2}-4\right)
$$

$$
\left\{\begin{array}{l}
\frac{\partial}{\partial x}=2 x-2 x y^{2}+2 \lambda x=0, \\
\frac{\partial}{\partial y}=4 y-2 x^{2} y+2 \lambda y=0,
\end{array}\right.
\text{ 解得 } \left\{\begin{array}{l}
x= \pm \sqrt{\frac{5}{2}} \\
y=\sqrt{\frac{3}{2}}
\end{array} \text { 或 }\left\{\begin{array}{l}
x=0 \\
y=2
\end{array}\right.\right.
$$

比较以上函数值，可得函数在区域 $D$ 上的最大值为 8，最小值为 0。

9. 要造一个容量一定的长方体箱子，问箱子的长、宽、高各为多少时，其表面积最小？

**解**：方法一 设箱子的长、宽、高分别为 $x, y, z$，容量为 $V$，表面积为 $S$，则

$$
V=x y z, \text { 其中 } x>0, y>0, z>0
$$

且 $S=2(x y+y z+z x)=2\left(x y+\frac{V}{x}+\frac{V}{y}\right)$，

令 $\left\{\begin{array}{l}S_{x}^{\prime}=2\left(y-\frac{V}{x^{2}}\right)=0, \\ S_{y}^{\prime}=2\left(x-\frac{V}{y^{2}}\right)=0,\end{array}\right.$

由实际意义知 $S$ 一定存在最小值，所以当长方体的长、宽、高均为 $\sqrt[3]{V}$ 时表面积最小，最小值为 $6 \sqrt[3]{V^{2}}$。

方法二 设箱子的长、宽、高分别为 $x, y, z$，容量为 $V$，表面积为 $S$，则

$$
V=x y z, \text { 其中 } x>0, y>0, z>0, \text { 且 } S=2(x y+y z+z x) \text {. }
$$

令 $F(x, y, z)=2(x y+y z+z x)+\lambda(x y z-V)$，

由 $\left\{\begin{array}{l}F_{x}^{\prime}=2 y+2 z+\lambda y z=0, \\ F_{y}^{\prime}=2 x+2 z+\lambda x z=0, \\ F_{z}^{\prime}=2 y+2 x+\lambda x y=0, \\ F_{x}^{\prime}=x y z-V=0\end{array}\right.$ 得唯一驻点 $(\sqrt[3]{V}, \sqrt[3]{V}, \sqrt[3]{V})$，

由实际意义知 $S$ 定存在最小值，所以当长方体的长、宽、高均为 $\sqrt[3]{V}$ 时表面积最小，最小值为 $6 \sqrt[3]{V^{2}}$。

10. 求函数 $z=\frac{x+y}{x^{2}+y^{2}+1}$ 的最大值和最小值。

**解**：由 $\left\{\begin{array}{l}z_{x}^{\prime}=\frac{1 \cdot\left(x^{2}+y^{2}+1\right)-2 x \cdot(x+y)}{\left(x^{2}+y^{2}+1\right)^{2}}=0, \\ z_{y}^{\prime}=\frac{1 \cdot\left(x^{2}+y^{2}+1\right)-2 y \cdot(x+y)}{\left(x^{2}+y^{2}+1\right)^{2}}=0\end{array}\right.$ 得 $\left\{\begin{array}{l}\left(x^{2}+y^{2}+1\right)-2 x(x+y)=0, \\ \left(x^{2}+y^{2}+1\right)-2 y(x+y)=0,\end{array}\right.$ 即 $\left\{\begin{array}{l}x=y, \\ 2 x^{2}+1-4 x^{2}=0,\end{array}\right.$ 得驻点 $\left(\frac{1}{\sqrt{2}}, \frac{1}{\sqrt{2}}\right)$ 和 $\left(-\frac{1}{\sqrt{2}},-\frac{1}{\sqrt{2}}\right)$，

计算 $z\left(\frac{1}{\sqrt{2}}, \frac{1}{\sqrt{2}}\right)=\frac{2 \times \frac{1}{\sqrt{2}}}{\frac{1}{2}+\frac{1}{2}+1}=\frac{1}{\sqrt{2}}, z\left(-\frac{1}{\sqrt{2}},-\frac{1}{\sqrt{2}}\right)=\frac{2 \times\left(-\frac{1}{\sqrt{2}}\right)}{\frac{1}{2}+\frac{1}{2}+1}=-\frac{1}{\sqrt{2}}$，

因为 $\lim _{\substack{x \rightarrow \infty \\ y \rightarrow \infty}} \frac{x+y}{x^{2}+y^{2}+1}=0$，所以最大值为 $\frac{1}{\sqrt{2}}$，最小值为 $-\frac{1}{\sqrt{2}}$。

11. (2008, 数二) 求函数 $u=x^{2}+y^{2}+z^{2}$ 在约束条件 $z=x^{2}+y^{2}$ 和 $x+y+z=4$ 下的最大和最小值。

**解**：设拉格朗日函数为

$$
F(x, y, z)=x^{2}+y^{2}+z^{2}+\lambda\left(z-x^{2}-y^{2}\right)+\mu(x+y+z-4)
$$

解方程组

$$
\left\{\begin{array}{l}
F_{x}^{\prime}(x, y, z)=2 x-2 \lambda x+\mu=0 \\
F_{y}^{\prime}(x, y, z)=2 y-2 \lambda y+\mu=0 \\
F_{z}^{\prime}(x, y, z)=2 z+\lambda+\mu=0 \\
F_{x}^{\prime}(x, y, z)=z-x^{2}-y^{2}=0 \\
F_{y}^{\prime}(x, y, z)=x+y+z-4=0
\end{array}\right.
$$

$$
\left\{\begin{array}{l}
x=-2, \\
y=-2, \\
z=8
\end{array} \quad\right.
$$

故最大值、最小值分别为

$$
u_{\max }=(-2)^{2}+(-2)^{2}+8^{2}=72, u_{\min }=1^{2}+1^{2}+2^{2}=6
$$

# 第四节 方向导数、梯度及几何应用

## 一、方向导数、梯度

二元函数 $f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 点沿 $\boldsymbol{l}=(a, b)\left(a^{2}+b^{2}=1\right)$ 方向的方向导数为

$$
\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial \boldsymbol{l}}=\lim _{t \rightarrow 0^{+}} \frac{f\left(x_{0}+a t, y_{0}+b t\right)-f\left(x_{0}, y_{0}\right)}{t}
$$

二元函数 $f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 点的梯度为 $\operatorname{grad} f\left(x_{0}, y_{0}\right)=\left(\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial x}, \frac{\partial f\left(x_{0}, y_{0}\right)}{\partial y}\right)$。

若二元函数 $f(x, y)$ 在 $\left(x_{0}, y_{0}\right)$ 点，则其在 $\left(x_{0}, y_{0}\right)$ 点沿 $\boldsymbol{l}=(a, b)\left(a^{2}+b^{2}=1\right)$ 方向的方向导数为

$$
\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial \boldsymbol{l}}=\operatorname{grad} f\left(x_{0}, y_{0}\right) \cdot \boldsymbol{l}
$$

**注释**：函数在某点沿着梯度的方向导数最大。

## 二、几何应用

1. **空间曲面的切平面**

显函数表示：$z=f(x, y)$。空间曲面过 $P_{0}\left(x_{0}, y_{0}\right)$ 的切平面方程为

$$
\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial x}\left(x-x_{0}\right)+\frac{\partial f\left(x_{0}, y_{0}\right)}{\partial y}\left(y-y_{0}\right)-\left(z-z_{0}\right)=0
$$

**注释**：曲面 $F(x, y, z)=0$ 在 $P_{z}\left(x_{0}, y_{0}, z_{0}\right)$ 处切平面的法向量为 $\left[F_{x}^{\prime}\left(x_{0}, y_{0}, z_{0}\right)\right.$, $\left.F_{y}^{\prime}\left(x_{0}, y_{0}, z_{0}\right), F_{x}^{\prime}\left(x_{0}, y_{0}, z_{0}\right)\right]$。

2. **空间曲线的切线**

空间曲面的参数方程 $\left\{\begin{array}{l}x=x(t), \\ y=y(t),(a \leqslant t \leqslant \beta) \text { 的切线为: } \\ z=z(t)\end{array}\right.$

$$
\left\{\begin{array}{l}
x=x_{0}+x^{\prime}\left(t_{0}\right)\left(t-t_{0}\right) \\
y=y_{0}+y^{\prime}\left(t_{0}\right)\left(t-t_{0}\right) \\
z=z_{0}+z^{\prime}\left(t_{0}\right)\left(t-t_{0}\right)
\end{array}\right.
$$

1. 设 $\boldsymbol{n}$ 是曲面 $2 x^{2}+3 y^{2}+z^{2}=6$ 在点 $P(1,1,1)$ 处的指向外侧的法向量，求函数 $u=\frac{\sqrt{6 x^{2}+8 y^{2}}}{z}$ 在点 $P$ 处沿方向 $\boldsymbol{n}$ 的方向导数。

**解**：设 $F(x, y, z)=2 x^{2}+3 y^{2}+z^{2}-6$，则

$$
F_{x}^{\prime}=4 x, F_{y}^{\prime}=6 y, F_{z}^{\prime}=2 z
$$

因此过点 $P(1,1,1)$ 处的指向外侧的法向量为 $\boldsymbol{n}=\{4,6,2\}$，单位化得 $\frac{\boldsymbol{n}}{|\boldsymbol{n}|}=\frac{1}{\sqrt{14}}\{2,3,1\}$。

仅数学一要求。

又

$$
\begin{aligned}
& \left.\frac{\partial u}{\partial x}\right|_{P}=\frac{6 x}{z \sqrt{6 x^{2}+8 y^{2}}}\left\lvert\, \begin{aligned}
& P=\frac{6}{\sqrt{14}} \\
& \left.\frac{\partial u}{\partial y}\right|_{P}=\frac{8 y}{z \sqrt{6 x^{2}+8 y^{2}}}\left.\right|_{P}=\frac{8}{\sqrt{14}} \\
& \left.\frac{\partial u}{\partial z}\right|_{P}=-\frac{\sqrt{6 x^{2}+8 y^{2}}}{z^{2}}\left.\right|_{P}=-\sqrt{14}
\end{aligned}
\end{aligned}
$$

于是有 $\left.\frac{\partial u}{\partial n}\right|_{P}=\frac{6}{\sqrt{14}} \times \frac{2}{\sqrt{14}}+\frac{8}{\sqrt{14}} \times \frac{3}{\sqrt{14}}-\sqrt{14} \times \frac{1}{\sqrt{14}}=\frac{11}{7}$。

12. 函数 $u=\ln \left(x^{2}+y^{2}+z^{2}\right)$ 在点 $M(1,2,-2)$ 处的梯度 $\left.\operatorname{grad} u\right|_{M}=$

**解**：直接根据梯度公式 $\operatorname{grad} u=\frac{\partial u}{\partial x} i+\frac{\partial u}{\partial y} j+\frac{\partial u}{\partial z} k$ 计算即可。

因为 $\frac{\partial u}{\partial x}=\frac{2 x}{x^{2}+y^{2}+z^{2}}, \frac{\partial u}{\partial y}=\frac{2 y}{x^{2}+y^{2}+z^{2}}, \frac{\partial u}{\partial z}=\frac{2 z}{x^{2}+y^{2}+z^{2}}$，

于是有 $\left.\operatorname{grad} u\right|_{M}=\frac{2}{9} i+\frac{4}{9} j-\frac{4}{9} k=\frac{2}{9}\{1,2,-2\}$。

13. 曲面 $z-\mathrm{e}^{x}+2 x y=3$ 在点 $(1,2,0)$ 处的切平面方程为

**解**：求出切平面的法向量，利用点法式写出切平面方程。

令 $F(x, y, z)=z-\mathrm{e}^{x}+2 x y-3$，则

$$
F_{x}^{\prime}=2 y, F_{y}^{\prime}=2 x, F_{z}^{\prime}=1-\mathrm{e}^{x}
$$

在点 $(1,2,0)$ 处的切平面的法向量为 $\{4,2,0\}$。于是点 $(1,2,0)$ 处的切平面方程为

$$
4(x-1)+2(y-2)=0, \text { 即 } 2 x+y-4=0
$$

14. (1993) 由曲线 $\left\{\begin{array}{l}3 x^{2}+2 y^{2}=12, \\ z=0\end{array}\right.$ 绕 $y$ 轴旋转一周得到的旋转面在点 $(0, \sqrt{3}, \sqrt{2})$ 处的指向外侧的单位法向量为

**解**：曲线 $\left\{\begin{array}{l}3 x^{2}+2 y^{2}=12, \\ z=0\end{array}\right.$ 绕 $y$ 轴旋转一周得到的旋转面为

$$
3\left(x^{2}+z^{2}\right)+2 y^{2}=12
$$

令 $F(x, y, z)=3\left(x^{2}+z^{2}\right)+2 y^{2}-12$，则

$$
F_{x}^{\prime}=6 x, F_{y}^{\prime}=4 y, F_{z}^{\prime}=6 z
$$

在点 $(0, \sqrt{3}, \sqrt{2})$ 处的法向量为 $\{0,4 \sqrt{3}, 6 \sqrt{2}\}$，于是点 $(0, \sqrt{3}, \sqrt{2})$ 处指向外侧的单位法向量为 $\frac{1}{\sqrt{5}}(0, \sqrt{2}, \sqrt{3})$。

15. 求曲线 $x=t-\sin t, y=1-\cos t, z=4 \sin \frac{t}{2}$ 在点 $t=\frac{\pi}{2}$ 处的切线方程和法平面方程。

**解**：曲线的切向量为

$$
\left\{1-\cos t, \sin t, 2 \cos \frac{t}{2}\right\}_{t=\frac{\pi}{2}}=\{1,1, \sqrt{2}\}
$$

切线方程为

$$
\frac{x+1-\frac{\pi}{2}}{1}=\frac{y-1}{1}=\frac{z-2 \sqrt{2}}{\sqrt{2}}
$$

法平面方程为

$$
x+y+\sqrt{2} z-\frac{\pi}{2}-4=0
$$

16. 求曲线 $\left\{\begin{array}{l}x^{2}+y^{2}+z^{2}=6, \\ x+y+z=0\end{array}\right.$ 在点 $(1,-2,1)$ 处的切线和法平面方程。

**解**：方程组两边对 $x$ 求导得

$$
\begin{aligned}
& \left\{\begin{array}{l}
2 x+2 y y^{\prime}+2 z z^{\prime}=0 \\
1+y^{\prime}+z^{\prime}=0
\end{array}\right. \\
& y^{\prime}=\frac{z-x}{y-z}, z^{\prime}=\frac{x-y}{y-z}
\end{aligned}
$$

得切线的方向向量为 $\{1,0,-1\}$，

切线方程为

$$
\frac{x-1}{1}=\frac{y+2}{0}=\frac{z-1}{-1}
$$

法平面方程为 $x-z=0$。
